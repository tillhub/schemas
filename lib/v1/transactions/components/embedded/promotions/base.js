const { oneOf } = require('../../../../../helpers/payload-or-null')

module.exports = {
  description: 'Promotion details applied on a transaction',
  additionalProperties: false,
  type: 'object',
  properties: {
    id: {
      type: 'string',
      format: 'uuid',
      example: 'AB3847a66-97dc-4ac2-8e8a-c44920e1f22f',
      description: 'Identifier of the promotion used.'
    },
    name: oneOf({
      type: 'string',
      example: 'Summer Sale',
      maxLength: 128,
      description: 'Name of the promotion.'
    }),
    compiled: {
      type: 'string',
      example: 'IWZ1bmN0aW9uKHQpe2lmKCJvYmplY3QiPT10eXBlb2YgZXhwb3J0cyYmInVuZGVmaW5lZCIhPXR5cGVvZiBtb2R1bGUpbW9kdWxlLmV4cG9ydHM9dCgpO2Vsc2UgaWYoImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sdCk7ZWxzZXsoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OiJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDoidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGY/c2VsZjp0aGlzKS5tYWluPXQoKX19KGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uIHQoZSxvLHIpe2Z1bmN0aW9uIG4odSxpKXtpZighb1t1XSl7aWYoIWVbdV0pe3ZhciBzPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFpJiZzKXJldHVybiBzKHUsITApO2lmKGYpcmV0dXJuIGYodSwhMCk7dmFyIGw9bmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIrdSsiJyIpO3Rocm93IGwuY29kZT0iTU9EVUxFX05PVF9GT1VORCIsbH12YXIgYT1vW3VdPXtleHBvcnRzOnt9fTtlW3VdWzBdLmNhbGwoYS5leHBvcnRzLGZ1bmN0aW9uKHQpe3JldHVybiBuKGVbdV1bMV1bdF18fHQpfSxhLGEuZXhwb3J0cyx0LGUsbyxyKX1yZXR1cm4gb1t1XS5leHBvcnRzfWZvcih2YXIgZj0iZnVuY3Rpb24iPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSx1PTA7dTxyLmxlbmd0aDt1KyspbihyW3VdKTtyZXR1cm4gbn19KCkoezE6W2Z1bmN0aW9uKHQsZSxvKXsidXNlIHN0cmljdCI7ZS5leHBvcnRzPWZ1bmN0aW9uKCl7bGV0IHQ9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOntpdGVtczpbXX07Y29uc3QgZT1bXSxvPVtdO2xldCByPTAsbj0wO2lmKHQuaXRlbXMuZm9yRWFjaCh0PT57IjFlMjcwNTNmLWZmZDEtNDk3Mi05YjEzLTdlMTBlNWJjODkwYyI9PT10LnByb2R1Y3RfaWQmJihyKz10LnF0eSksIjFlMjcwNTNmLWZmZDEtNDk3Mi05YjEzLTdlMTBlNWJjODkwYyI9PT10LnByb2R1Y3RfaWQmJihuKz10LnF0eSxlLnB1c2goT2JqZWN0LmFzc2lnbih7fSx0KSkpfSksIWUubGVuZ3RoKXJldHVybiBvO2NvbnN0IGY9ZnVuY3Rpb24odCxlLG8scil7cmV0dXJuIHIuYW1vdW50X3RvdGFsX2dyb3NzLHIucXR5LDV9KDAsMCwwLGVbMF0pLHU9TWF0aC5mbG9vcihyLzEpLGk9TWF0aC5mbG9vcihuLzEpO2xldCBzPXU8PWk/dTppO2lmKCEocz1NYXRoLmZsb29yKG4vMikpKXJldHVybiBvO2xldCBsPTA7Zm9yKGxldCB0IG9mIGUpe2NvbnN0IGU9dC5xdHk7aWYoIShNYXRoLmNlaWwoKGwrdC5xdHkpLzEpPD1zKSl7aWYobHx8cyl7Y29uc3Qgcj0xKnMtbCxuPXIqZix1PShlLXIpKih0LmFtb3VudF90b3RhbF9ncm9zcy9lKTt0LnByb21vdGVkX3RvdGFsX2dyb3NzPWEobit1LDIpLHQucHJvbW90YWJsZV9xdHk9cixkZWxldGUgdC5hbW91bnRfdG90YWxfZ3Jvc3Msby5wdXNoKHQpLHM9MH1icmVha31zLT1NYXRoLmZsb29yKChsK2UpLzEpLGw9KGwrZSklMSx0LnByb21vdGVkX3RvdGFsX2dyb3NzPWEoZSpmLDIpLHQucHJvbW90YWJsZV9xdHk9ZSxkZWxldGUgdC5hbW91bnRfdG90YWxfZ3Jvc3Msby5wdXNoKHQpfXJldHVybiBvO2Z1bmN0aW9uIGEodCxlKXtyZXR1cm4gTnVtYmVyKE1hdGgucm91bmQodCsiZSIrZSkrImUtIitlKX19fSx7fV19LHt9LFsxXSkoMSl9KTs=',
      description: 'Base64 of the promotion function'
    }
  }
}
